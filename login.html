<!DOCTYPE html>
<html lang="en">
<head>
  <title>Login Siswa | TRY OUT</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body style="background: linear-gradient(135deg, #326698 0%, #4a7fb8 100%, #667eea 100%); font-family: 'Poppins', sans-serif;">

<div class="container-fluid text-white" 
	style="background: linear-gradient(135deg, #326698 0%, #4a7fb8 100%); box-shadow: 0 4px 20px rgba(0,0,0,0.1); height:120px; position:fixed; top:0px; left:0px; right:0px; z-index:1000;"
	>
	  <div class="row h-100 align-items-center">
		<div class="col-12">
			<div class="d-flex align-items-center justify-content-center">
				<div class="logo-container mr-4">
					<img style="height:60px; filter: drop-shadow(0 2px 10px rgba(0,0,0,0.2));" src="smpn10.jpg ">
				</div>
				<div class="header-text">
					<h3 class="mb-1" style="font-weight: 700; font-size: 20px; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">SMPN 10 BANAWA SELATAN</h3>
					<p class="mb-0" style="font-size: 14px; opacity: 0.9; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">TRY OUT - LOGIN SISWA</p>
				</div>
			</div>
		</div>
	  </div>
</div>

<div class="wrapper " style="margin: 0 auto; display: flex; justify-content: center; align-items: center; min-height: 100vh; padding-top: 140px;">
  <div id="formContent">
    <div class="fadeIn text-center">
      <div class="header-icon mb-4">
        <div class="icon-circle">
          <i class="fas fa-user-lock"></i>
        </div>
        <h4 class="mt-3 mb-1" style="color: #333; font-weight: 600;">Login Siswa</h4>
        <p class="text-muted" style="font-size: 14px;" id="mapel-info">Memuat mata pelajaran...</p>
      </div>
      
      <div class="form-group text-left">
		<label class="form-label"><i class="fas fa-user mr-2"></i><b>Username:</b></label>
		<input type="text" id="username" class="form-control custom-select" placeholder="Masukkan username">
	  </div>
	  
	  <div class="form-group text-left">
		<label class="form-label"><i class="fas fa-key mr-2"></i><b>Password:</b></label>
		<input type="password" id="password" class="form-control custom-select" placeholder="Masukkan password">
	  </div>
	  
	  <div class="text-center mt-4">
		<button type="button" class="btn btn-primary btn-lg btn-block custom-btn" onClick="handleLogin()">
		  <i class="fas fa-sign-in-alt mr-2"></i>Login
		</button>
		<button type="button" class="btn btn-secondary btn-lg btn-block" onClick="window.location.href='index.html'" style="background: #6c757d; border-radius: 12px; padding: 14px;">
		  <i class="fas fa-arrow-left mr-2"></i>Kembali
		</button>
	  </div>
      
    </div>
  </div> 
</div>

<div  style="position:absolute;top:0px;left:0px;right:0px;bottom:0px;background:#fff;opacity:0.5;z-index:99999;display:none" id="loader">
<img class="loader" src="https://pusmendik.kemdikbud.go.id/tka/_assets/images/loader2.gif">
</div>

<style>
/* ... (Salin semua CSS dari index.html) ... */
	.bg-pattern {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-image: 
			radial-gradient(circle at 20% 20%, rgba(255,255,255,0.1) 2px, transparent 2px),
			radial-gradient(circle at 80% 80%, rgba(255,255,255,0.08) 2px, transparent 2px),
			radial-gradient(circle at 40% 40%, rgba(255,255,255,0.05) 1px, transparent 1px);
		background-size: 50px 50px, 80px 80px, 30px 30px;
		z-index: -1;
	}
	.loader {
	  margin: 0;
	  position: absolute;
	  top: 50%;
	  left: 50%;
	  -ms-transform: translate(-50%, -50%);
	  transform: translate(-50%, -50%);
	}
	.wrapper {
	  display: flex;
	  align-items: center;
	  flex-direction: column; 
	  justify-content: center;
	  width: 100%;
	  min-height: 100vh;
	  padding: 20px;
	  margin: 0 auto;
	  text-align: center;
	}
	.logo-container {
		display: flex;
		align-items: center;
	}
	.header-text h3 {
		margin: 0;
		letter-spacing: 1px;
	}
	.header-text p {
		margin: 0;
		font-weight: 400;
	}
	#formContent {
	  -webkit-border-radius: 20px;
	  border-radius: 20px;
	  background: #ffffff;
	  padding: 45px;
	  width: 90%;
	  max-width: 480px;
	  position: relative;
	  -webkit-box-shadow: 0 15px 35px 0 rgba(50, 102, 152, 0.1);
	  box-shadow: 0 15px 35px 0 rgba(50, 102, 152, 0.1);
	  text-align: center;
	  border: 1px solid rgba(255,255,255,0.8);
	}
	.header-icon .icon-circle {
		width: 80px;
		height: 80px;
		border-radius: 50%;
		background: linear-gradient(135deg, #326698 0%, #4a7fb8 100%);
		display: flex;
		align-items: center;
		justify-content: center;
		margin: 0 auto;
		box-shadow: 0 10px 30px rgba(50, 102, 152, 0.2);
		border: 2px solid rgba(50, 102, 152, 0.1);
	}
	.header-icon .icon-circle i {
		font-size: 35px;
		color: white;
	}
	.form-label {
		color: #333;
		font-weight: 600;
		margin-bottom: 10px;
		font-size: 14px;
		display: flex;
		align-items: center;
	}
	.form-label i {
		color: #326698;
		margin-right: 8px;
		font-size: 16px;
	}
	.custom-select {
		border: 2px solid #e8ecf1;
		border-radius: 12px;
		padding: 14px 18px;
		font-size: 15px;
		font-weight: 500;
		transition: all 0.3s ease;
		background-color: #fff;
		background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4 5"><path fill="%23326698" d="M2 0L0 2h4zm0 5L0 3h4z"/></svg>');
		background-repeat: no-repeat;
		background-position: right 15px center;
		background-size: 12px;
		appearance: none;
		-webkit-appearance: none;
		-moz-appearance: none;
		cursor: pointer;
		box-shadow: 0 2px 8px rgba(50, 102, 152, 0.08);
		height:auto;
	}
	.custom-select:focus {
		border-color: #326698;
		box-shadow: 0 0 0 3px rgba(50, 102, 152, 0.1), 0 4px 16px rgba(50, 102, 152, 0.15);
		outline: none;
		transform: translateY(-1px);
	}
	.custom-select:hover {
		border-color: #4a7fb8;
		box-shadow: 0 4px 12px rgba(50, 102, 152, 0.12);
	}
	.custom-select option {
		padding: 12px;
		font-weight: 500;
		color: #333;
		background-color: #fff;
	}
	.custom-select option:hover {
		background-color: #f8f9fa;
	}
	.custom-btn {
		background: linear-gradient(135deg, #326698 0%, #4a7fb8 100%);
		border: none;
		border-radius: 12px;
		padding: 16px 30px;
		font-weight: 600;
		font-size: 16px;
		transition: all 0.3s ease;
		box-shadow: 0 6px 20px rgba(50, 102, 152, 0.25);
		position: relative;
		overflow: hidden;
	}
	.custom-btn::before {
		content: '';
		position: absolute;
		top: 0;
		left: -100%;
		width: 100%;
		height: 100%;
		background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
		transition: left 0.5s;
	}
	.custom-btn:hover::before {
		left: 100%;
	}
	.custom-btn:hover {
		transform: translateY(-2px);
		box-shadow: 0 8px 25px rgba(50, 102, 152, 0.35);
		background: linear-gradient(135deg, #4a7fb8 0%, #326698 100%);
	}
	.custom-btn:active {
		transform: translateY(0);
	}
	.form-group {
		margin-bottom: 30px;
		position: relative;
	}
	.form-group:last-of-type {
		margin-bottom: 20px;
	}
	.footer-info {
		position: fixed;
		bottom: 15px;
		left: 0;
		right: 0;
		z-index: 10;
	}
	.copyright-card {
		background: rgba(255, 255, 255, 0.95);
		padding: 10px 20px;
		border-radius: 25px;
		font-size: 12px;
		color: #333;
		box-shadow: 0 4px 15px rgba(0,0,0,0.08);
		border: 1px solid rgba(255,255,255,0.5);
		display: inline-flex;
		align-items: center;
		margin: 0 auto;
	}
	.copyright-card i {
		color: #326698;
	}
	@media (max-width: 768px) {
		#formContent {
			margin: 20px;
			padding: 35px 25px;
		}
		
		.header-icon .icon-circle {
			width: 60px;
			height: 60px;
		}
		
		.header-icon .icon-circle i {
			font-size: 25px;
		}
		
		.footer-info {
			bottom: 10px;
		}
		
		.copyright-card {
			font-size: 10px;
			padding: 8px 15px;
		}
		.container-fluid {
			height: 100px !important;
		}
		.header-text h3 {
			font-size: 20px !important;
		}
		.header-text p {
			font-size: 12px !important;
		}
		.logo-container img {
			height: 45px !important;
		}
		.custom-select {
			padding: 12px 16px;
			font-size: 14px;
		}
		.form-label {
			font-size: 13px;
		}
		.custom-btn {
			padding: 14px 25px;
			font-size: 15px;
		}
	}
	#loader {
		background: rgba(50, 102, 152, 0.1);
	}
	.error-input {
		border-color: #dc3545 !important;
		box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25) !important;
		animation: shake 0.5s ease-in-out;
	}
	@keyframes shake {
		0%, 100% { transform: translateX(0); }
		25% { transform: translateX(-5px); }
		75% { transform: translateX(5px); }
	}
	.custom-notification {
		backdrop-filter: blur(10px);
	}
	.custom-notification:hover {
		transform: translateX(-5px) !important;
	}
	@media (max-width: 768px) {
		.custom-notification {
			right: 10px !important;
			left: 10px !important;
			max-width: none !important;
			top: 130px !important;
		}
	}
	@keyframes floating {
		0%, 100% { transform: translateY(0px); }
		50% { transform: translateY(-10px); }
	}
	.header-icon .icon-circle {
		animation: floating 3s ease-in-out infinite;
	}
</style>

<script>
	// ⬇️ GANTI DENGAN URL APPS SCRIPT BARU ANDA DARI LANGKAH 2 ⬇️
	var SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzPNXT4fZ4_CEyOAfHYlHcoJNs7oscRa-fiJjpQqEtIoP0xuV9obeLzk6ywl7T_BeSfRw/exec";

	$(document).ready(function() {
		// Ambil data mapel dari sesi
		var mapelData = JSON.parse(sessionStorage.getItem('mapel_tryout'));
		
		if (mapelData) {
			$('#mapel-info').text('Mata Pelajaran: ' + mapelData.nama);
		} else {
			// Jika tidak ada mapel, paksa kembali ke index.html
			showNotification('Anda harus memilih mata pelajaran terlebih dahulu!', 'error');
			setTimeout(() => {
				window.location.href = 'index.html';
			}, 2000);
		}
	});

	function handleLogin() {
		var username = $('#username').val();
		var password = $('#password').val();

		if (!username || !password) {
			showNotification('Username dan Password tidak boleh kosong!', 'error');
			return;
		}

		$('#loader').fadeIn();
		$('.custom-btn').prop('disabled', true).html('Logging in...');

		$.ajax({
			type: "GET",
			dataType: "json",
			data: { 
				action: "checkLogin",
				username: username,
				password: password
			},
			url: SCRIPT_URL,
			cache: false,
			success: function(result) {
				$('#loader').fadeOut();
				$('.custom-btn').prop('disabled', false).html('<i class="fas fa-sign-in-alt mr-2"></i>Login');

				if (result.status === 'success') {
					// Simpan data user ke session
					sessionStorage.setItem('user_tryout', JSON.stringify(result));
					showNotification('Login berhasil! Selamat datang, ' + result.nama, 'success');
					
					// Arahkan ke halaman simulasi
					setTimeout(() => {
						window.location.href = 'simulasi.html';
					}, 1500);
					
				} else {
					showNotification(result.message, 'error');
					$('#username').addClass('error-input');
					$('#password').addClass('error-input');
					setTimeout(() => {
						$('#username, #password').removeClass('error-input');
					}, 3000);
				}
			},
			error: function() {
				$('#loader').fadeOut();
				$('.custom-btn').prop('disabled', false).html('<i class="fas fa-sign-in-alt mr-2"></i>Login');
				showNotification('Gagal terhubung ke server login.', 'error');
			}
		});
	}

	// Salin fungsi showNotification dari index.html ke sini
	function showNotification(message, type = 'info') {
		$('.custom-notification').remove();
		const iconClass = type === 'error' ? 'fa-exclamation-circle' : 
						 type === 'success' ? 'fa-check-circle' : 
						 type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle';
		const bgColor = type === 'error' ? '#dc3545' : 
					   type === 'success' ? '#28a745' : 
					   type === 'warning' ? '#ffc107' : '#007bff';
		const notification = $(`
			<div class="custom-notification" style="
				position: fixed; top: 140px; right: 20px; background: ${bgColor}; color: white;
				padding: 15px 20px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.3);
				z-index: 10001; display: flex; align-items: center; max-width: 400px;
				opacity: 0; transform: translateX(100%); transition: all 0.3s ease;
				font-family: 'Poppins', sans-serif;
			">
				<i class="fas ${iconClass} mr-3" style="font-size: 18px;"></i>
				<span style="font-weight: 500;">${message}</span>
				<button onclick="$(this).closest('.custom-notification').fadeOut(300)" style="
					background: none; border: none; color: white; margin-left: 15px;
					cursor: pointer; font-size: 16px; opacity: 0.8;
				">
					<i class="fas fa-times"></i>
				</button>
			</div>
		`);
		$('body').append(notification);
		setTimeout(() => {
			notification.css({'opacity': '1', 'transform': 'translateX(0)'});
		}, 100);
		setTimeout(() => {
			notification.fadeOut(300, function() { $(this).remove(); });
		}, 5000);
	}
</script>
</body>
</html>
